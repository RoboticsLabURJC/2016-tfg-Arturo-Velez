\hspace{1 cm}La vista es el sentido que más utilizamos para captar información de nuestro entorno y consiste en la habilidad de detectar la luz y de interpretarla. Tanto los humanos como los animales poseemos un sistema visual que nos permite crear un esquema de nuestro entorno y conocer detalles de los objetos que nos rodean. Gracias a estos detalles somos capaces de reconocer dichos objetos por su color, por su forma, detectar movimiento en ellos o incluso estimar aproximadamente la distancia que nos separa.\\

	Cada vez está más a la orden del día el comportamiento autónomo de las máquinas,  ya que cada día estas se parecen más al humano, gracias a que les hemos dotado de capacidades perceptivas y sensores con los cuales pueden percibir la realidad, como por ejemplo cámaras. Mediante algoritmos y gracias a la capacidad de procesamiento que tienen, se pueden tratar las informaciones que reciben de sus sensores para otorgarles cierta autonomía en función de la aplicación que vayamos a dar a cada máquina en concreto.\\

	Este trabajo de fin de grado es una aplicación directa de control visual. Consiste en un sistema automático que permite a un drone seguir a un objeto móvil mediante la detección de puntos de interés en la imagen. El seguimiento se ha validado experimentalmente en un entorno virtual, pero es aplicable al mundo real. Este trabajo se sitúa por tanto en la intersección entre dos campos: la robótica aérea (en concreto los drones) y la visión artificial.
	
\section{Visión artificial}
\hspace{1 cm}La visión artificial o visión por computador es una disciplina que incluye métodos para adquirir, procesar, analizar y comprender las imágenes del mundo real con el fin de producir información numérica o simbólica para que puedan ser tratados por un computador.\\

	El objetivo principal que tiene esta disciplina es que las máquinas sean capaces de ver e interpretar el mundo como un humano lo hace observando con sus ojos y procesando la información en el cerebro. Para ello, las máquinas encargadas de esto son dotadas de cámaras para percibir la realidad, tomando una o varias imágenes para posteriormente analizarla en su procesador. La comprensión de esta ``realidad'' captada por los sensores está basada en el procesamiento de la imagen o imágenes mediante algoritmos, geometría, estadística y otras disciplinas.\\
	
	La adquisición de estas imágenes no siempre es perfecta, existen ruidos e interferencias de diferente naturaleza, y éstas pueden provocar un mal procesamiento de la mismas dando lugar a errores. Existen diferentes técnicas de preprocesamiento de imágenes para que estas sean lo más fidedignas posible a la realidad como muestra la figura 1.1.\\
	
\begin{figure} [H]
  \begin{center}
    \includegraphics[width=0.5\textwidth]{figuras/ruido.jpg}
  \end{center}
  \caption{Preprocesamiento para reducción de ruido.}
  \label{fig:ruido}
\end{figure}

Una vez que se ha realizado el preprocesamiento de la imagen, ésta se puede utilizar con diversos fines. Dos de los más empleados son el aprendizaje automatizado (\textit{machine learning}) y la detección de objetos.\\

	El primero utiliza técnicas que tienen como objetivo, por ejemplo, diferenciar automáticamente patrones usando algoritmos matemáticos. Se pueden distinguir dos tipos de técnicas:
	
	\begin{itemize}
	\item Apredizaje supervisado: Con este aprendizaje se entrena al ordenador con patrones previamente etiquetados, de forma que el algoritmo que emplee la máquina debe encontrar las fronteras que separan los posibles tipos de patrones.
	\item Aprendizaje no supervisado: Con este aprendizaje se entrena al ordenador con patrones que no han sido previamente clasificados y es el propio ordenador el que debe extraer los distintos patrones en diferentes clases.
	\end{itemize} 

El segundo, la detección de objetos, es la parte de la visión artificial que estudia cómo detectar la presencia de objetos en una imagen sobre la base de su apariencia visual. Quizá la parte más importante es la extracción de características. Ésta consiste en la obtención de modelos matemáticos compactos que hagan que la información de la imagen sea más simple con el fin de que el proceso de reconocimiento de objetos sea más sencillo. Las características que estos modelos obtienen se llaman descriptores, entre los que podemos encontrar histogramas, LBP, HOG, SIFT, SURF, ORB... Para la búsqueda de objetos se pueden utilizar técnicas de aprendizaje automatizado para encontrar los clasificadores apropiados y que la detección se realice correctamente.\\

\subsection{Aplicaciones}
Algunas aplicaciones de visión artificial que están teniendo mucho auge en la actualidad son el coche autónomo, el reconocimiento de caracteres y la visión en medicina. Entre estas aplicaciones destaca el coche autónomo debido a que ya es una realidad y podemos encontrarnos estos vehículos dotados de cámaras en nuestras carreteras circulando entre coches no autónomos.\\

Los vehículos autónomos perciben el entorno mediante sensores como láser, radar, lidar, sistema de posicionamiento global y visión computarizada. Los sistemas avanzados de control interpretan la información para identificar la ruta apropiada, así como los obstáculos y la señalización relevante utilizando el hardware anteriormente mencionado. Mediante las cámaras se detectan los objetos para mantener el control del vehículo por la carretera, identificando las líneas o los márgenes de éstas. También son capaces de identificar otros vehículos y peatones prediciendo su trayectoria mediante un software desarrollado para ello. El sistema de cámara lo complementa con un sistema de radares situados en el vehículo con el cual son capaces de controlar con más precisión la distancia a la cual se encuentra el objeto detectado. De esta manera, el vehículo es capaz de interpretar la realidad de una manera muy parecida a la que podría hacer un humano.\\

\begin{figure} [H]
  \begin{center}
    \includegraphics[width=0.5\textwidth]{figuras/autopilot.jpg}
  \end{center}
  \caption{Coche autónomo y los datos que procesa, incluyendo imágenes}
  \label{fig:autopilot}
\end{figure}


Otra aplicación es OCR, que son las siglas de \textit{Optical Character Recognition}. Es un proceso dirigido a la digitalización de textos, los cuales identifican automáticamente, a partir de una imagen dada, símbolos o caracteres que pertenecen a un determinado alfabeto, para luego almacenarlos en forma de datos. Así podremos interactuar con estos mediante un programa de edición de texto o similar. En los últimos años la digitalización de la información (textos, imágenes, sonido, etcétera) ha devenido en un punto de interés para la sociedad. En el caso concreto de los textos, existen y se generan continuamente grandes cantidades de información escrita, tipográfica o manuscrita en todo tipo de soportes. En este contexto, automatizar la introducción de caracteres evitando la entrada por teclado implica un importante ahorro de recursos humanos y un aumento de la productividad, al mismo tiempo que se mantiene, o hasta se mejora, la calidad de muchos servicios. También se lleva utilizando durante muchos años en el reconocimiento de matrículas de vehículos con los radares, proporcionando una cadena de caracteres que se tienen que ajustar a un modelo conocido: el formato de una matrícula.\\

\begin{figure} [H]
  \begin{center}
    \includegraphics[width=0.5\textwidth]{figuras/matricula.jpg}
  \end{center}
  \caption{Acceso a parking mediante OCR.}
  \label{fig:matricula}
\end{figure}

El mundo de la medicina también ha aplicado la tecnología de la visión artificial. En la medicina deportiva se está empezando a utilizar una técnica de detección de lesiones en atletas mediante cámaras térmicas. La imagen tomada por estas cámaras es procesada para localizar los puntos calientes en el cuerpo del deportista, sinónimo de que en la zona detectada existe la posibilidad de que haya una lesión\footnote{http://blog.infaimon.com/2014/05/la-termografia-como-herramienta-de-diagnostico-en-medicina-deportiva/}. También se está desarrollando un proyecto que tiene como objetivo principal permitir a las personas sin ningún tipo de movimiento en las extremidades superiores y que no pueden controlar los movimientos de la cabeza, controlar un ratón del ordenador sólo con el movimiento de los ojos mediante una cámara y un seguimiento de los mismos \footnote{http://www.magickey.ipg.pt/}.
\\
\begin{figure}[h] % indico que voy a poner una figura y [h] indica que la posición relativa, tambien puedo usar t = top entre otros.
\hfill
\begin{minipage}[t]{.45\textwidth}
\begin{center}
    \includegraphics[width=0.8\textwidth]{figuras/termo.jpg}
  \end{center}
  \caption{Termoimagen para detección de puntos calientes}
  \label{fig:termo}
\end{minipage}
\hfill
\begin{minipage}[t]{.45\textwidth}
\begin{center}
    \includegraphics[width=0.8\textwidth]{figuras/ojos.jpg}
  \end{center}
  \caption{Proyecto MagicEye del Instituto Politécnico de Guarda}
  \label{fig:ojos}
\end{minipage}
\hfill
\end{figure}


\section{Drones (UAV)}
\hspace{1 cm}Un vehículo aéreo no tripulado (VANT), UAV (Unmanned Aerial Vehicle) o drone es una aeronave que vuela sin tripulación, concretamente se define como un vehículo sin tripulación reutilizable, capaz de mantener de manera autónoma un nivel de vuelo controlado y sostenido siendo propulsado por uno o varios motores.\\

\begin{figure} [H]
  \begin{center}
    \includegraphics[width=0.5\textwidth]{figuras/dji.jpg}
  \end{center}
  \caption{Cuadricóptero, drone con cuatro motores.}
  \label{fig:dji}
\end{figure}


Históricamente, los drones se emplearon para entrenar a los soldados en el uso de cañones antiaéreos. Posteriormente, cuando se desarrollaron más, era posible controlarlos remotamente gracias en parte a que además habían mejorado su autonomía. Unos de los drones más conocidos es el MQ-1 Predator de General Atomics, utilizado por el ejército americano, primero en misiones de reconocimiento y posteriormente en misiones de ataque.\\

Actualmente el drone se ha hecho muy comercial en el ámbito civil, gracias en parte al abaratamiento de costes. Hay empresas importantes que comercializan estas aeronaves tales como Syma o DJI, las cuales son de las más punteras. Este tipo de aparatos pueden ser equipados con cámaras entre otros tipos de sensores como GPS, IMU, barómetro y brújulas.\\ 

\begin{figure} [H]
  \begin{center}
    \includegraphics[width=0.5\textwidth]{figuras/predator.jpg}
  \end{center}
  \caption{Drone MQ-1 Predator equipado para ataque.}
  \label{fig:predator}
\end{figure}

Gracias a todo esto los drones hoy en día son empleados en aplicaciones agrícolas, vigilancia de fronteras y terrenos, búsquedas en zonas de difícil acceso, topografía, ocio, producciones audiovisuales e inspección de infraestructuras. Entre las líneas de desarrollo en las que se está trabajando con drones, se encuentra Amazon Prime Air \footnote{https://www.amazon.com/Amazon-Prime-Air/b?node=8037720011} e Intel Asctec Firefly \footnote{http://www.asctec.de/en/uav-uas-drones-rpas-roav/asctec-firefly/}. Amazon, una de las empresas líder de compras por internet, está desarrollando un drone con el cual podrá realizar sus entregas de una manera más rápida. Este drone va equipado con cámaras con las cuales detecta las etiquetas destino de la persona a la cual tiene que entregar el paquete (Figura 1.8). Desde el momento en que se despacha el paquete hasta que éste es recogido por el comprador, es totalmente autónomo. Por otro lado, el proyecto de Intel consiste en la generación de un mapa 3D con unas cámaras que lleva el drone y así controlar las distancias con los objetos, evitando colisiones (Figura 1.9).\\

\begin{figure}[h] % indico que voy a poner una figura y [h] indica que la posición relativa, tambien puedo usar t = top entre otros.
\hfill
\begin{minipage}[t]{.45\textwidth}
\begin{center}
    \includegraphics[width=0.8\textwidth]{figuras/amazon.jpg}
  \end{center}
  \caption{Amazon Prime Air: proceso de aterrizaje}
  \label{fig:amazon}
\end{minipage}
\hfill
\begin{minipage}[t]{.45\textwidth}
\begin{center}
    \includegraphics[width=0.8\textwidth]{figuras/asctect.jpg}
  \end{center}
  \caption{Intel Asctec Firefly: cámaras y detrás, mapa creado}
  \label{fig:asctect}
\end{minipage}
\hfill
\end{figure}



Un drone principalmente es un robot aéreo, compuesto de hardware y software. El hardware que compone a estos robots consta de actuadores, entre los que podemos encontrar sistemas de vuelo y hélices para otorgar la movilidad al robot, además de los sensores que éste puede llevar embarcados. Todo este hardware es controlado mediante un software, que puede ser de mayor o menor complejidad en función del uso que se le vaya a dar al drone, pudiendo ser éste controlado desde una tableta o smartphone o mediante una programación de rutas. Gracias al software también se puede asumir una locomoción resuelta y estable gracias a los mecanismos de control implementados.\\

\subsection{Marco legal}
En conceptos legales, la nueva ley temporal que regula el uso de drones en España fue aprobada el 4 de julio de 2014. Esta nueva ley va dirigida a los drones con un peso menor de 150 kg, quedando definidas las condiciones en las que se puede emplear un drone, entre las que se encuentran: grabación, vigilancia y monitorización, revisión de infraestructuras y obtención de mapas.\\

Inicialmente los drones se categorizan según su masa. Los menores de 2 kg, los que tienen entre 2 kg y 25 kg y los superiores a 25 kg. A medida que aumenta la masa, su uso está más controlado. Los drones con un peso menor de 25 kg tienen una restricción por la que se prohíbe su vuelo a altitudes superiores a 120 metros. Sea cual sea su masa, es necesario tener el carnet de piloto de drones para poder manejar estos vehículos. Además, la aeronave deberá llevar una placa identificativa con el nombre del fabricante y los datos fiscales de la empresa.\\

El carnet oficial para el manejo de drones no será necesario para aquellos que dispongan de un título de piloto de avión, ultraligero u otro específico. Sin embargo, los demás necesitan pasar unos exámenes y pruebas oficiales para obtenerlo. Es importante que la escuela en la que se realice el curso sea ATO, es decir, escuelas certificadas por AESA. Hay dos cursos, uno normal y otro avanzado. El curso normal sólo habilita para volar el vehículo mientras lo tengas a la vista y el avanzado permite todo el alcance de la aeronave.\\

En cuanto a su uso en el espacio aéreo, si se quiere utilizar un dron es necesario pedir un permiso con una antelación de cinco días a la AESA (Agencia Estatal de Seguridad Aérea). Está prohibido sobrevolar núcleos urbanos o espacios con una gran masificación de gente sin el consentimiento de AESA. Por seguridad será necesario tener un manual de operaciones cumplimentado, además de un estudio de seguridad de cada una de las operaciones que se llevarán a cabo. Cualquier infracción de las normas anteriores comportaría sanciones económicas de entre 3 000 y 60 000\euro.

\section{Antecedentes}
\hspace{1 cm}Es necesario situar en contexto este trabajo de fin de grado. Actualmente, hay presentados tres trabajos que guardan relación con el presente. Estos son los trabajos de Aitor Martínez\footnote{\textit{Tecnologías web en plataforma robótica JdeRobot.} Proyecto Fin de Carrera, URJC, 2016. http://jderobot.org/Aitormf-tfg}, Iván Rodríguez\footnote{\textit{Manejo de un drone con webrtc y JdeRobot.} Proyecto Fin de Carrera, URJC, 2016. http://jderobot.org/Irodmar-tfg} y Alberto Martín Florido\footnote{\textit{Navegación visual en un cuadricóptero para el seguimiento de objetos.} Proyecto Fin de Carrera, URJC, 2014. http://jderobot.org/Amartinflorido-tfg}.\\

En los dos primeros la temática principal se basa en el control de la aeronave mediante diferentes aplicaciones. En el caso de Aitor Martínez, su trabajo consiste no sólo en el manejo de aeronaves, sino de diferentes clases de robots mediante un interfaz web. En el caso de Iván Rodríguez, su trabajo consiste en el control de un drone, empleando para ello la tecnología webRTC.\\

En el último mencionado, siendo éste el que más se asemeja al desarrollo del presente trabajo, es el proyecto llevado a cabo por Alberto Martín Florido. Su objetivo principal se basa en el seguimiento de objetos con unas características marcadas, tales como la forma y el color. Gracias a la percepción visual del drone en 3D y a los mecanismos de control, el drone es capaz de seguir un objeto de color llamativo.\\

Hay que destacar también los trabajos desarrollados por Jorge Cano\footnote{http://jderobot.org/J.canoma-tfg}, el cual ha construido un drone el cual embarca distintos dispositivos y ha desarrollado los drivers mediante los cuales sería posible llevar la aplicación desarrollada en este trabajo a un drone real.\\

Y el trabajo de Daniel Yagüe\footnote{http://jderobot.org/Daniyague-pfc}, el cual ha desarrollado un driver para un drone simulado en terreno virtual. Este driver se ha utilizado en el presente trabajo de fin de grado.\\

El laboratorio de robótica ha organizado también el campeonato de programación de drones en el cual planteaban el reto de programación de un drone (gato) para que busque, persiga a otro robot aéreo (ratón) y se mantenga cerca de él, basándose en la información recibida de las cámaras que este lleva instaladas. El campeonato se desarrolla empleando un mundo virtual de Gazebo, una simulador 3D que se explicará más adelante.

\begin{figure} [H]
  \begin{center}
    \includegraphics[width=0.5\textwidth]{figuras/gatoraton.jpg}
  \end{center}
  \caption{Campeonato de Drones de JdeRobot}
  \label{fig:gatoraton}
\end{figure}

En el momento que se desarrollaba este trabajo de fin de grado, se estaban desarrollando paralelamente otros como por ejemplo el de Manuel Zafra\footnote{http://jderobot.org/Mazafrav-pfc}, en el cual se desarrolla la navegación 3D en interiores, o el de Jorge Vela\footnote{http://jderobot.org/Jvela-tfg}, el cual desarrolla un algoritmo mediante el cual el drone es capaz de buscar y aterrizar encima de un coche, o el trabajo de Diego Jiménez, el cual se centra en el soporte para el Solo Drone 3DR. \\

El presente trabajo de fin de grado aporta a este estado del arte una nueva forma de proceso de la información visual, siendo capaz de realizar un seguimiento de objetos complejos que se asemejan más a la realidad, es decir, objetos con textura.\\

En esta memoria se explica el desarrollo de esta nueva aplicación empezando por los objetivos iniciales marcados, siguiendo con la infraestructura empleada y concluyendo con las pruebas experimentales y conclusiones que se han obtenidodrone.\\







	
